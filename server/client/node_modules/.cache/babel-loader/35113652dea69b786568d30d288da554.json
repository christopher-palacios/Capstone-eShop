{"ast":null,"code":"import _regeneratorRuntime from\"/Users/christopherpalacios/Desktop/christopher-palacios-capstone-c41/eShop/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/christopherpalacios/Desktop/christopher-palacios-capstone-c41/eShop/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/christopherpalacios/Desktop/christopher-palacios-capstone-c41/eShop/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{createContext,useState,useEffect}from\"react\";import swal from\"sweetalert\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";var baseUrl=\"http://localhost:8080/api\";export var AppContext=/*#__PURE__*/createContext();export var ContextProvider=function ContextProvider(_ref){var children=_ref.children;var token=localStorage.getItem(\"token\");// const user = localStorage.getItem(\"user\");\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),selectedCategory=_useState2[0],setSelectedCategory=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),productList=_useState4[0],setProductList=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),selectedProduct=_useState6[0],setSelectedProduct=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),categoryList=_useState10[0],setCategoryList=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),randomItems=_useState12[0],setRandomItems=_useState12[1];var _useState13=useState(),_useState14=_slicedToArray(_useState13,2),currentUser=_useState14[0],setCurrentUser=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),drop=_useState16[0],setDrop=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),cart=_useState18[0],setCart=_useState18[1];var _useState19=useState(),_useState20=_slicedToArray(_useState19,2),purchased=_useState20[0],setPurchased=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),showCheckoutModal=_useState22[0],setShowCheckoutModal=_useState22[1];var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),logInModalShow=_useState24[0],setLogInModalShow=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),signUpModalShow=_useState26[0],setSignUpModalShow=_useState26[1];var _useState27=useState(false),_useState28=_slicedToArray(_useState27,2),isSignedIn=_useState28[0],setIsSignedIn=_useState28[1];var storage=JSON.parse(localStorage.getItem(\"guestCart\"));var guestCart={isOpen:true,products:[],cartQuantity:0,cartTotal:0};//Get list of categories\nvar getCategoryList=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:axios.get(\"\".concat(baseUrl,\"/categories\")).then(function(res){setCategoryList(res.data);}).catch(function(err){return swal(err.message);});case 1:case\"end\":return _context.stop();}}},_callee);}));return function getCategoryList(){return _ref2.apply(this,arguments);};}();//Get product list\nvar getProductList=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:axios.get(\"\".concat(baseUrl,\"/product/list\")).then(function(res){setProductList(res.data);}).catch(function(err){return swal(err.message);});case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function getProductList(){return _ref3.apply(this,arguments);};}();//CART FUNCTIONS//\n//Get cart\nvar getCart=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:axios.get(\"\".concat(baseUrl,\"/cart\"),{headers:{authorization:\"Bearer \".concat(token)}}).then(function(res){return setCart(res.data);}).catch(function(err){return swal(\"getCart\",err.message);});case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function getCart(){return _ref4.apply(this,arguments);};}();//INCREASE product quantity in cart\nvar increaseQty=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(product,cartId){var _guestCart,index;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(token){_context4.next=11;break;}_guestCart=JSON.parse(localStorage.getItem(\"guestCart\"));//find product index in guest cart\nindex=_guestCart.products.map(function(product){return product.name;}).indexOf(product.name);//update product quantity\n_guestCart.products[index].quantity=_guestCart.products[index].quantity+1;_guestCart.products[index].productTotal=_guestCart.products[index].productTotal+product.price;//recalculate cart totals\n_guestCart.cartTotal=_guestCart.products.map(function(product){return product.productTotal;}).reduce(function(acc,curr){return acc+curr;});_guestCart.cartQuantity=_guestCart.products.map(function(product){return product.quantity;}).reduce(function(acc,curr){return acc+curr;});//save guest cart to state and local storage\nsetCart(_guestCart);localStorage.setItem(\"guestCart\",JSON.stringify(_guestCart));_context4.next=20;break;case 11:if(!token){_context4.next=20;break;}_context4.prev=12;_context4.next=15;return axios.put(\"\".concat(baseUrl,\"/cart/increase/\").concat(cartId),{product:product,cartId:cartId},{headers:{authorization:\"Bearer \".concat(token)}}).then(function(res){return setCart(res.data);},setLoading(false));case 15:_context4.next=20;break;case 17:_context4.prev=17;_context4.t0=_context4[\"catch\"](12);swal(\"Please login or create an account to add items to your cart\",_context4.t0.message);case 20:case\"end\":return _context4.stop();}}},_callee4,null,[[12,17]]);}));return function increaseQty(_x,_x2){return _ref5.apply(this,arguments);};}();//DECREASE product quantity in cart\nvar decreaseQty=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(product,cartId){var _guestCart2,index;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(token){_context5.next=11;break;}_guestCart2=JSON.parse(localStorage.getItem(\"guestCart\"));//find product index in guest cart\nindex=_guestCart2.products.map(function(product){return product.name;}).indexOf(product.name);//update product quantity\n_guestCart2.products[index].quantity=_guestCart2.products[index].quantity-1;_guestCart2.products[index].productTotal=_guestCart2.products[index].productTotal-product.price;//recalculate cart totals\n_guestCart2.cartTotal=_guestCart2.products.map(function(product){return product.productTotal;}).reduce(function(acc,curr){return acc+curr;});_guestCart2.cartQuantity=_guestCart2.products.map(function(product){return product.quantity;}).reduce(function(acc,curr){return acc+curr;});//save guest cart to state and local storage\nsetCart(_guestCart2);localStorage.setItem(\"guestCart\",JSON.stringify(_guestCart2));_context5.next=19;break;case 11:_context5.prev=11;_context5.next=14;return axios.put(\"\".concat(baseUrl,\"/cart/decrease/\").concat(cartId),{product:product},{headers:{authorization:\"Bearer \".concat(token)}}).then(function(res){return setCart(res.data);}).catch(function(err){return swal(err.message);});case 14:_context5.next=19;break;case 16:_context5.prev=16;_context5.t0=_context5[\"catch\"](11);swal(_context5.t0.message);case 19:case\"end\":return _context5.stop();}}},_callee5,null,[[11,16]]);}));return function decreaseQty(_x3,_x4){return _ref6.apply(this,arguments);};}();//DELETE selected product from cart\nvar deleteProduct=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(product,cartId){var _guestCart3;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(token){_context6.next=7;break;}_guestCart3=JSON.parse(localStorage.getItem(\"guestCart\"));//remove selected product from guest cart\nif(_guestCart3.products.length===1){_guestCart3.products=[];_guestCart3.cartTotal=0;_guestCart3.cartQuantity=0;}else if(_guestCart3.products.length>1){_guestCart3.products=_guestCart3.products.filter(function(item){return item.name!==product.name;});//recalculate cart totals\n_guestCart3.cartTotal=_guestCart3.products.map(function(product){return product.productTotal;}).reduce(function(acc,curr){return acc+curr;});_guestCart3.cartQuantity=_guestCart3.products.map(function(product){return product.quantity;}).reduce(function(acc,curr){return acc+curr;});}//save guest cart to state and local storage\nsetCart(_guestCart3);localStorage.setItem(\"guestCart\",JSON.stringify(_guestCart3));_context6.next=15;break;case 7:_context6.prev=7;_context6.next=10;return axios.put(\"\".concat(baseUrl,\"/cart/delete/\").concat(cartId),{product:product,cartId:cartId},{headers:{authorization:\"Bearer \".concat(token)}}).then(function(res){return setCart(res.data);}).catch(function(err){return swal(err.message);});case 10:_context6.next=15;break;case 12:_context6.prev=12;_context6.t0=_context6[\"catch\"](7);swal(_context6.t0.message);case 15:case\"end\":return _context6.stop();}}},_callee6,null,[[7,12]]);}));return function deleteProduct(_x5,_x6){return _ref7.apply(this,arguments);};}();// const getRandom = () => {\n//   const randomIndex = Math.floor(Math.random() * categoryList?.length);\n//   const randomId = categoryList[randomIndex]?._id;\n//   axios.get(`${baseUrl}/categories/${randomId}`).then((res) => {\n//     setRandomItems(res.data);\n//     console.log(res.data);\n//   });\n// };\nuseEffect(function(){getCategoryList();getProductList();// getRandom();\nif(!token&&storage===null){setCart(guestCart);localStorage.setItem(\"guestCart\",JSON.stringify(guestCart));}else if(!token&&storage){var _guestCart4=JSON.parse(localStorage.getItem(\"guestCart\"));setCart(_guestCart4);}if(token){localStorage.removeItem(\"guestCart\");getCart();}},[token]);return/*#__PURE__*/_jsx(AppContext.Provider,{value:{randomItems:randomItems,setRandomItems:setRandomItems,isSignedIn:isSignedIn,setIsSignedIn:setIsSignedIn,logInModalShow:logInModalShow,setLogInModalShow:setLogInModalShow,signUpModalShow:signUpModalShow,setSignUpModalShow:setSignUpModalShow,showCheckoutModal:showCheckoutModal,setShowCheckoutModal:setShowCheckoutModal,selectedCategory:selectedCategory,setSelectedCategory:setSelectedCategory,selectedProduct:selectedProduct,setSelectedProduct:setSelectedProduct,loading:loading,setLoading:setLoading,categoryList:categoryList,setCategoryList:setCategoryList,productList:productList,currentUser:currentUser,setCurrentUser:setCurrentUser,getCategoryList:getCategoryList,drop:drop,setDrop:setDrop,cart:cart,setCart:setCart,token:token,increaseQty:increaseQty,decreaseQty:decreaseQty,deleteProduct:deleteProduct,purchased:purchased,setPurchased:setPurchased},children:children});};","map":{"version":3,"sources":["/Users/christopherpalacios/Desktop/christopher-palacios-capstone-c41/eShop/client/src/AppContext/AppContext.jsx"],"names":["React","createContext","useState","useEffect","swal","axios","baseUrl","AppContext","ContextProvider","children","token","localStorage","getItem","selectedCategory","setSelectedCategory","productList","setProductList","selectedProduct","setSelectedProduct","loading","setLoading","categoryList","setCategoryList","randomItems","setRandomItems","currentUser","setCurrentUser","drop","setDrop","cart","setCart","purchased","setPurchased","showCheckoutModal","setShowCheckoutModal","logInModalShow","setLogInModalShow","signUpModalShow","setSignUpModalShow","isSignedIn","setIsSignedIn","storage","JSON","parse","guestCart","isOpen","products","cartQuantity","cartTotal","getCategoryList","get","then","res","data","catch","err","message","getProductList","getCart","headers","authorization","increaseQty","product","cartId","index","map","name","indexOf","quantity","productTotal","price","reduce","acc","curr","setItem","stringify","put","decreaseQty","deleteProduct","length","filter","item","removeItem"],"mappings":"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","sourcesContent":["import React, { createContext, useState, useEffect } from \"react\";\nimport swal from \"sweetalert\";\nimport axios from \"axios\";\n\nconst baseUrl = \"http://localhost:8080/api\";\n\nexport const AppContext = createContext();\n\nexport const ContextProvider = ({ children }) => {\n  const token = localStorage.getItem(\"token\");\n  // const user = localStorage.getItem(\"user\");\n  const [selectedCategory, setSelectedCategory] = useState([]);\n  const [productList, setProductList] = useState([]);\n  const [selectedProduct, setSelectedProduct] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [categoryList, setCategoryList] = useState([]);\n  const [randomItems, setRandomItems] = useState([]);\n  const [currentUser, setCurrentUser] = useState();\n  const [drop, setDrop] = useState(\"\");\n  const [cart, setCart] = useState([]);\n  const [purchased, setPurchased] = useState();\n  const [showCheckoutModal, setShowCheckoutModal] = useState(false);\n  const [logInModalShow, setLogInModalShow] = useState(false);\n  const [signUpModalShow, setSignUpModalShow] = useState(false);\n  const [isSignedIn, setIsSignedIn] = useState(false);\n  let storage = JSON.parse(localStorage.getItem(\"guestCart\"));\n  const guestCart = {\n    isOpen: true,\n    products: [],\n    cartQuantity: 0,\n    cartTotal: 0,\n  };\n\n  //Get list of categories\n  const getCategoryList = async () => {\n    axios\n      .get(`${baseUrl}/categories`)\n      .then((res) => {\n        setCategoryList(res.data);\n      })\n      .catch((err) => swal(err.message));\n  };\n\n  //Get product list\n  const getProductList = async () => {\n    axios\n      .get(`${baseUrl}/product/list`)\n      .then((res) => {\n        setProductList(res.data);\n      })\n      .catch((err) => swal(err.message));\n  };\n\n  //CART FUNCTIONS//\n\n  //Get cart\n  const getCart = async () => {\n    axios\n      .get(`${baseUrl}/cart`, {\n        headers: {\n          authorization: `Bearer ${token}`,\n        },\n      })\n      .then((res) => setCart(res.data))\n      .catch((err) => swal(\"getCart\", err.message));\n  };\n\n  //INCREASE product quantity in cart\n  const increaseQty = async (product, cartId) => {\n    if (!token) {\n      let guestCart = JSON.parse(localStorage.getItem(\"guestCart\"));\n      //find product index in guest cart\n      let index = guestCart.products\n        .map((product) => product.name)\n        .indexOf(product.name);\n      //update product quantity\n      guestCart.products[index].quantity =\n        guestCart.products[index].quantity + 1;\n      guestCart.products[index].productTotal =\n        guestCart.products[index].productTotal + product.price;\n      //recalculate cart totals\n      guestCart.cartTotal = guestCart.products\n        .map((product) => product.productTotal)\n        .reduce((acc, curr) => acc + curr);\n      guestCart.cartQuantity = guestCart.products\n        .map((product) => product.quantity)\n        .reduce((acc, curr) => acc + curr);\n      //save guest cart to state and local storage\n      setCart(guestCart);\n      localStorage.setItem(\"guestCart\", JSON.stringify(guestCart));\n    } else if (token) {\n      try {\n        await axios\n          .put(\n            `${baseUrl}/cart/increase/${cartId}`,\n            { product, cartId },\n            {\n              headers: {\n                authorization: `Bearer ${token}`,\n              },\n            }\n          )\n          .then((res) => setCart(res.data), setLoading(false));\n      } catch (error) {\n        swal(\n          \"Please login or create an account to add items to your cart\",\n          error.message\n        );\n      }\n    }\n  };\n\n  //DECREASE product quantity in cart\n  const decreaseQty = async (product, cartId) => {\n    if (!token) {\n      let guestCart = JSON.parse(localStorage.getItem(\"guestCart\"));\n      //find product index in guest cart\n      let index = guestCart.products\n        .map((product) => product.name)\n        .indexOf(product.name);\n      //update product quantity\n      guestCart.products[index].quantity =\n        guestCart.products[index].quantity - 1;\n      guestCart.products[index].productTotal =\n        guestCart.products[index].productTotal - product.price;\n      //recalculate cart totals\n      guestCart.cartTotal = guestCart.products\n        .map((product) => product.productTotal)\n        .reduce((acc, curr) => acc + curr);\n      guestCart.cartQuantity = guestCart.products\n        .map((product) => product.quantity)\n        .reduce((acc, curr) => acc + curr);\n      //save guest cart to state and local storage\n      setCart(guestCart);\n      localStorage.setItem(\"guestCart\", JSON.stringify(guestCart));\n    } else {\n      try {\n        await axios\n          .put(\n            `${baseUrl}/cart/decrease/${cartId}`,\n            { product },\n            {\n              headers: {\n                authorization: `Bearer ${token}`,\n              },\n            }\n          )\n          .then((res) => setCart(res.data))\n          .catch((err) => swal(err.message));\n      } catch (error) {\n        swal(error.message);\n      }\n    }\n  };\n\n  //DELETE selected product from cart\n  const deleteProduct = async (product, cartId) => {\n    if (!token) {\n      let guestCart = JSON.parse(localStorage.getItem(\"guestCart\"));\n      //remove selected product from guest cart\n      if (guestCart.products.length === 1) {\n        guestCart.products = [];\n        guestCart.cartTotal = 0;\n        guestCart.cartQuantity = 0;\n      } else if (guestCart.products.length > 1) {\n        guestCart.products = guestCart.products.filter(\n          (item) => item.name !== product.name\n        );\n        //recalculate cart totals\n        guestCart.cartTotal = guestCart.products\n          .map((product) => product.productTotal)\n          .reduce((acc, curr) => acc + curr);\n        guestCart.cartQuantity = guestCart.products\n          .map((product) => product.quantity)\n          .reduce((acc, curr) => acc + curr);\n      }\n\n      //save guest cart to state and local storage\n      setCart(guestCart);\n      localStorage.setItem(\"guestCart\", JSON.stringify(guestCart));\n    } else {\n      try {\n        await axios\n          .put(\n            `${baseUrl}/cart/delete/${cartId}`,\n            { product, cartId },\n            {\n              headers: {\n                authorization: `Bearer ${token}`,\n              },\n            }\n          )\n          .then((res) => setCart(res.data))\n          .catch((err) => swal(err.message));\n      } catch (error) {\n        swal(error.message);\n      }\n    }\n  };\n  // const getRandom = () => {\n  //   const randomIndex = Math.floor(Math.random() * categoryList?.length);\n  //   const randomId = categoryList[randomIndex]?._id;\n\n  //   axios.get(`${baseUrl}/categories/${randomId}`).then((res) => {\n  //     setRandomItems(res.data);\n  //     console.log(res.data);\n  //   });\n  // };\n\n  useEffect(() => {\n    getCategoryList();\n    getProductList();\n    // getRandom();\n    if (!token && storage === null) {\n      setCart(guestCart);\n      localStorage.setItem(\"guestCart\", JSON.stringify(guestCart));\n    } else if (!token && storage) {\n      let guestCart = JSON.parse(localStorage.getItem(\"guestCart\"));\n      setCart(guestCart);\n    }\n\n    if (token) {\n      localStorage.removeItem(\"guestCart\");\n      getCart();\n    }\n  }, [token]);\n\n  return (\n    <AppContext.Provider\n      value={{\n        randomItems,\n        setRandomItems,\n        isSignedIn,\n        setIsSignedIn,\n        logInModalShow,\n        setLogInModalShow,\n        signUpModalShow,\n        setSignUpModalShow,\n        showCheckoutModal,\n        setShowCheckoutModal,\n        selectedCategory,\n        setSelectedCategory,\n        selectedProduct,\n        setSelectedProduct,\n        loading,\n        setLoading,\n        categoryList,\n        setCategoryList,\n        productList,\n        currentUser,\n        setCurrentUser,\n        getCategoryList,\n        drop,\n        setDrop,\n        cart,\n        setCart,\n        token,\n        increaseQty,\n        decreaseQty,\n        deleteProduct,\n        purchased,\n        setPurchased,\n      }}\n    >\n      {children}\n    </AppContext.Provider>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}