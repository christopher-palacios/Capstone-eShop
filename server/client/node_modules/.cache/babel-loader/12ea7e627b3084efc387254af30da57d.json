{"ast":null,"code":"import _slicedToArray from\"/Users/christopherpalacios/Desktop/christopher-palacios-capstone-c41/eShop/server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import axios from\"axios\";import{Form,Button}from\"react-bootstrap\";import React,{useEffect,useState,useContext}from\"react\";import{AppContext}from\"../../AppContext/AppContext\";import swal from\"sweetalert\";import\"./ProductDetail.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var baseUrl=\"https://localhost:8080/api\";function OnSale(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),selectedProduct=_useState2[0],setSelectedProduct=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,1),quantity=_useState4[0];var _useContext=useContext(AppContext),setCart=_useContext.setCart,token=_useContext.token,currentUser=_useContext.currentUser;var handleSubmit=function handleSubmit(product){var price=product.price.slice(0,9).split(\",\").join(\"\");//if not current user\nif(!token){var storage=localStorage.getItem(\"guestCart\");var guestCart=JSON.parse(storage);var isExist=guestCart.products.map(function(product){return product.name;}).includes(product.name);if(!isExist){var newProduct={quantity:1,productTotal:Number(product.price),productId:product._id,name:product.name,price:Number(product.price),image:product.image,category:product.category};//add new product to guest cart\nguestCart.products.push(newProduct);//recalculate totals for cart\nguestCart.cartTotal=guestCart.products.map(function(product){return Number(product.productTotal);}).reduce(function(acc,curr){return acc+curr;});guestCart.cartQuantity=guestCart.products.map(function(product){return Number(product.quantity);}).reduce(function(acc,curr){return acc+curr;});//save carts to state and local storage\nlocalStorage.setItem(\"guestCart\",JSON.stringify(guestCart));setCart(guestCart);swal(\"Success!\",\"Item has beeen added to cart\");}else if(isExist){//find index of existing product in guest cart\nvar existingIndex=guestCart.products.map(function(product){return product.name;}).indexOf(product.name);//update existing product totals\nguestCart.products[existingIndex].productTotal=Number(guestCart.products[existingIndex].productTotal)+Number(product.price);guestCart.products[existingIndex].quantity=Number(guestCart.products[existingIndex].quantity)+1;//recalculate cart totals\nguestCart.cartTotal=guestCart.products.map(function(product){return product.productTotal;}).reduce(function(acc,curr){return acc+curr;});guestCart.cartQuantity=guestCart.products.map(function(product){return product.quantity;}).reduce(function(acc,curr){return acc+curr;});//save guest cart to state and local storage\nsetCart(guestCart);swal(\"Success!\",\"Item has beeen updated\");localStorage.setItem(\"guestCart\",JSON.stringify(guestCart));}}if(token){axios.post(\"\".concat(baseUrl,\"/cart\"),{quantity:quantity,product:product,price:price},{headers:{authorization:\"Bearer \".concat(token)}}).then(function(res){setCart(res.data);swal(\"Success!\",\"Item has beeen added to cart\");}).catch(function(err){return swal(\"Please sign in to continue shopping\");});}};useEffect(function(){var id=props.match.params.id;axios.get(\"\".concat(baseUrl,\"/product/\").concat(id)).then(function(res){var selectedProduct=res.data;setSelectedProduct(selectedProduct);});},[props.match.params]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"product\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"product__img\",alt:\"product img\",src:selectedProduct.image}),/*#__PURE__*/_jsxs(\"div\",{className:\"product__details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"product__details--top\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"product__details--info\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"product__details--title\",children:selectedProduct.name}),/*#__PURE__*/_jsx(\"h3\",{className:\"product__details--category\",children:selectedProduct.category}),/*#__PURE__*/_jsxs(\"h4\",{children:[\"Price: \",selectedProduct.price]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product__details--action\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"product__details--qty\",children:/*#__PURE__*/_jsx(Form,{})}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){handleSubmit(selectedProduct);},className:\"product__details--add\",variant:\"outline-dark\",children:\"ADD TO CART\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"product__details--footer\",children:/*#__PURE__*/_jsx(\"p\",{children:selectedProduct.description})})]})]})});}export default OnSale;","map":{"version":3,"sources":["/Users/christopherpalacios/Desktop/christopher-palacios-capstone-c41/eShop/server/client/src/pages/ProductDetail/ProductDetail.jsx"],"names":["axios","Form","Button","React","useEffect","useState","useContext","AppContext","swal","baseUrl","OnSale","props","selectedProduct","setSelectedProduct","quantity","setCart","token","currentUser","handleSubmit","product","price","slice","split","join","storage","localStorage","getItem","guestCart","JSON","parse","isExist","products","map","name","includes","newProduct","productTotal","Number","productId","_id","image","category","push","cartTotal","reduce","acc","curr","cartQuantity","setItem","stringify","existingIndex","indexOf","post","headers","authorization","then","res","data","catch","err","id","match","params","get","description"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport { Form, Button } from \"react-bootstrap\";\nimport React, { useEffect, useState, useContext } from \"react\";\nimport { AppContext } from \"../../AppContext/AppContext\";\nimport swal from \"sweetalert\";\nimport \"./ProductDetail.scss\";\n\nconst baseUrl = \"https://localhost:8080/api\";\n\nfunction OnSale(props) {\n  const [selectedProduct, setSelectedProduct] = useState([]);\n  const [quantity] = useState(1);\n  const { setCart, token, currentUser } = useContext(AppContext);\n\n  const handleSubmit = (product) => {\n    const price = product.price.slice(0, 9).split(\",\").join(\"\");\n    //if not current user\n    if (!token) {\n      let storage = localStorage.getItem(\"guestCart\");\n      let guestCart = JSON.parse(storage);\n      const isExist = guestCart.products\n        .map((product) => product.name)\n        .includes(product.name);\n      if (!isExist) {\n        let newProduct = {\n          quantity: 1,\n          productTotal: Number(product.price),\n          productId: product._id,\n          name: product.name,\n          price: Number(product.price),\n          image: product.image,\n          category: product.category,\n        };\n        //add new product to guest cart\n        guestCart.products.push(newProduct);\n        //recalculate totals for cart\n        guestCart.cartTotal = guestCart.products\n          .map((product) => Number(product.productTotal))\n          .reduce((acc, curr) => acc + curr);\n        guestCart.cartQuantity = guestCart.products\n          .map((product) => Number(product.quantity))\n          .reduce((acc, curr) => acc + curr);\n        //save carts to state and local storage\n        localStorage.setItem(\"guestCart\", JSON.stringify(guestCart));\n        setCart(guestCart);\n        swal(\"Success!\", \"Item has beeen added to cart\");\n      } else if (isExist) {\n        //find index of existing product in guest cart\n        const existingIndex = guestCart.products\n          .map((product) => product.name)\n          .indexOf(product.name);\n        //update existing product totals\n        guestCart.products[existingIndex].productTotal =\n          Number(guestCart.products[existingIndex].productTotal) +\n          Number(product.price);\n        guestCart.products[existingIndex].quantity =\n          Number(guestCart.products[existingIndex].quantity) + 1;\n        //recalculate cart totals\n        guestCart.cartTotal = guestCart.products\n          .map((product) => product.productTotal)\n          .reduce((acc, curr) => acc + curr);\n        guestCart.cartQuantity = guestCart.products\n          .map((product) => product.quantity)\n          .reduce((acc, curr) => acc + curr);\n        //save guest cart to state and local storage\n        setCart(guestCart);\n        swal(\"Success!\", \"Item has beeen updated\");\n        localStorage.setItem(\"guestCart\", JSON.stringify(guestCart));\n      }\n    }\n    if (token) {\n      axios\n        .post(\n          `${baseUrl}/cart`,\n          {\n            quantity,\n            product,\n            price,\n          },\n          {\n            headers: {\n              authorization: `Bearer ${token}`,\n            },\n          }\n        )\n        .then((res) => {\n          setCart(res.data);\n          swal(\"Success!\", \"Item has beeen added to cart\");\n        })\n        .catch((err) => swal(\"Please sign in to continue shopping\"));\n    }\n  };\n\n  useEffect(() => {\n    const { id } = props.match.params;\n    axios.get(`${baseUrl}/product/${id}`).then((res) => {\n      const selectedProduct = res.data;\n      setSelectedProduct(selectedProduct);\n    });\n  }, [props.match.params]);\n  return (\n    <>\n      <div className=\"product\">\n        <img\n          className=\"product__img\"\n          alt=\"product img\"\n          src={selectedProduct.image}\n        ></img>\n        <div className=\"product__details\">\n          <div className=\"product__details--top\">\n            <div className=\"product__details--info\">\n              <h1 className=\"product__details--title\">\n                {selectedProduct.name}\n              </h1>\n              <h3 className=\"product__details--category\">\n                {selectedProduct.category}\n              </h3>\n              <h4>Price: {selectedProduct.price}</h4>\n            </div>\n            <div className=\"product__details--action\">\n              <div className=\"product__details--qty\">\n                <Form></Form>\n              </div>\n              <Button\n                onClick={() => {\n                  handleSubmit(selectedProduct);\n                }}\n                className=\"product__details--add\"\n                variant=\"outline-dark\"\n              >\n                ADD TO CART\n              </Button>\n            </div>\n          </div>\n          <div className=\"product__details--footer\">\n            <p>{selectedProduct.description}</p>\n          </div>\n          {/* <div className=\"product__review\">\n              <div className=\"product__review--card\">\n                <div className=\"product__review--head\">\n                  <h3>user</h3>\n                  <h3>timestamp</h3>\n                </div>\n                <h3>review text goes here</h3>\n              </div>\n            </div> */}\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default OnSale;\n"]},"metadata":{},"sourceType":"module"}